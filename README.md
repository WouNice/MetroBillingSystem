# 题目：地铁计费系统

乘坐地铁时，需要对交通卡/单程卡进行计费。现在开发一个地铁计费系统实现对乘客的计费和约束。

## 系统约束

1. 每个乘客有自己ID，在录入时生成，全局唯一。
2. 每个乘客有自己名称、金额，并能够拥有一张交通卡或是一张单程卡（只能二选一），不能拥有多张交通卡或是单程卡。
3. 乘客购买交通卡时需要冲入金额，如果超过自己拥有的金额则充值失败。
4. 每条地铁线有自己的ID，在录入时生成，全局唯一，每条地铁线有自己的名称，录入时记录。
5. 每个地铁站点有自己的ID，在录入时生成，全局唯一，每个地铁站点有自己的名称，权值（1~3），录入时记录。
6. 每条地铁线有5个以上，20个以下的地铁站点，站点根据录入的顺序记录。
7. 一条地铁线只能与其他地铁线有1个换乘站点（假设有3条地铁线A,B,C如果A与B已有一个换乘站点，则不允许A与B再有另一个换乘站点，但允许A与C有另一个站点换乘）。换乘站点即两条地铁线共用一个地铁站点。
8. 购买单程卡时需要指定起始和终止站点，系统根据起始和终止站点，自动计算单程卡金额。当起始到终止站点有多条路线时，按路线计费规则9选取价格最少的一条路线计费。
9. 路线计费规则：每个站点有自己的权值，一条路线的计费按照起始到终止站点中间经过的所有站点的权值相加（不包含起始站点，包含终止站点）。
10. 使用交通卡乘坐地铁时，指定起始和终止站点，当起始到终止站点有多条路线时，按路线计费规则9选取价格最少的一条路线计费。计费时直接扣去交通卡中的金额。当交通卡中金额不足时，则超出部分按失信规则12记录失信。
11. 使用单程卡乘坐时，如果乘坐时没有按照单程卡指定的起始/终止站点乘坐，按照计费规则9进行计费，多条路线按最小计费，如果小于等于单程卡的购买价格则乘坐成功，如果大于单程卡的购买金额，则超出部分按失信规则12记录失信。
12. 失信规则：乘坐金额不足时，直接扣取乘客自有金额，并计入失信记录一次，当失信记录超过三次时进入失信黑名单不允许再乘坐地铁，如果自有金额不够抵扣时直接进入失信黑名单。

## 编码实现如下Rest接口

1. 乘客数据的录入、删除、修改、查询；

   查询时除返回ID、名字、剩余金额等信息还需要返回乘坐历史记录信息。

2. 地铁线录入、查询（不做修改和删除）

3. 地铁站点录入、查询（不做修改和删除）

   查询时除返回ID、名字、权值等信息还需要换乘站点信息（如果是）。

4. 换乘站点关联接口，即关联录入的A地铁线的某个站点与B地铁线的某个站点为同一个站点，即为换乘站点。

5. 交通卡充值（没有的时候充值即购买）；

6. 购买单程卡；

7. 乘坐。

   乘坐指定乘客、起始站点、终止站点。

8. 查询失信黑名单。

   返回失信人员信息和其失信记录。

## 要求

1. 用SpringBoot+SpringMVC+mybatis+mysql实现
2. 编写单元测试